\renewcommand{\figdir}{Fig} % figure directory

% Computational performance

\plot{float}{width=\textwidth}{
	{Comparison between the number of flops (equations \ref{eq:float_fast_eqlayer} and \ref{eq:float_bccb}) 
	associated with the fast equivalent-layer technique \citep{siqueira-etal2017} and our method, 
	for $N$ varying from $5\,000$ to $1\,000\,000$. All values are computed with $N^{it} = 50$ 
	iterations and $\kappa = 5$.}
	\label{fig:float}
}

\plot{time_comparison}{width=10cm}{
	{Comparison between the running time of the fast equivalent-layer technique \citep{siqueira-etal2017} and our method.
	The values were obtained for $N^{it} = 50$ iterations.}
	\label{fig:time_fast_eqlayer_bccb}
}

\plot{time_bccb}{width=10cm}{
	{Running time of our method for a number of observations $N$ up to $25$ millions. 
	The values were obtained for $N^{it} = 50$ iterations.}
	\label{fig:time_bccb}
}

% Application to synthetic data

\plot{synthetic_data}{width=13.5cm}{
	{Noise-corrupted gravity data (in color map) produced by three synthetic sources: 
	a sphere with density contrast $-0.5\, \mathrm{g/cm^3}$ and 
	two rectangular prisms with density contrasts $0.35\, \mathrm{g/cm^3}$ (upper-left body) and 
	$0.4\, \mathrm{g/cm^3}$ (upper-right body). The black lines represent the horizontal projection 
	of the sources.}
	\label{fig:synthetic_data}
}

\plot{classic_fast_val}{width=8cm}{
	{(a) Predicted data produced by the fast equivalent-layer technique \citep{siqueira-etal2017}. 
	(b) Residuals between the simulated (Figure \ref{fig:synthetic_data}) and 
	predicted (shown in a) data. The mean and standard deviation are $8.264 \times 10^{-7}$ and $0.0144$ mGal,
	respectively.}
	\label{fig:classic_fast_val}
}

\plot{bccb_fast_val}{width=8cm}{
	{(a) Predicted data produced by our method. 
	(b) Residuals between the simulated (Figure \ref{fig:synthetic_data}) and 
	predicted (shown in a) data. The mean and standard deviation are $8.264 \times 10^{-7}$ and $0.0144$ mGal,
	respectively.}
	\label{fig:bccb_fast_val}
}

\plot{delta_comparison}{width=13.5cm}{
	{Difference between the predicted data produced by the fast equivalent-layer technique 
	(Figure \ref{fig:classic_fast_val}a) and by our method (Figure \ref{fig:bccb_fast_val}a).}
	\label{fig:delta_comparison}
}

\plot{delta_rho}{width=13.5cm}{
	{Difference between the estimated mass distribution within the equivalent layers produced by 
	the fast equivalent-layer technique (not shown) and by our method (not shown).}
	\label{fig:delta_rho}
}

\plot{upward_comparison}{width=5cm}{
	{The upward-continued gravity data obtained with (a) the fast equivalent-layer technique 
	\citep{siqueira-etal2017} and (b) our method. (c) Residuals between 
	panels a and b with mean $-5.938 \times 10^{-18}$ mGal and standard deviation $8.701 \times 10^{-18}$ mGal. 
	The total computation times spent by the fast equivalent-layer technique and our method 
	are $7.62026$ and $0.00834$ seconds, respectively.}
	\label{fig:upward_comparison}
}

\plot{downward_comparison}{width=5cm}{
	{The downward-continued gravity data obtained with (a) the fast equivalent-layer technique 
	\citep{siqueira-etal2017} and (b) our method. (c) Residuals between 
	panels a and b with mean $5.914 \times 10^{-18}$ mGal and standard deviation $9.014 \times 10^{-18}$ mGal. 
	The total computation times spent by the fast equivalent-layer technique and our method 
	are $7.59654$ and $0.00547$ seconds, respectively.}
	\label{fig:downward_comparison}
}

% Application to field data

\plot{carajas_real_data}{width=13.5cm}{
	{Caraj\'as Province, Brazil. Gravity data on a regular grid of $500 \times 500$ points, totaling $250,000$ observations.
	The inset shows the study area (blue rectangle) which covers the southeast part of the state of Par\'a, north of Brazil.}
	\label{fig:carajas_real_data}
}

\plot{carajas_gz_predito_val}{width=8cm}{
	{Caraj\'as Province, Brazil. (a) Predicted gravity data produced by our modification of the fast equivalent-layer 
	method \citep{siqueira-etal2017}  that computes the forward modeling using the properties of BTTB and BCCB matrices
	(equation \ref{eq:w_Cv}). (b) Gravity residuals, defined as the difference between the observed data in 
	Figure \ref{fig:carajas_real_data} and the predicted data in panel a, with their mean of 0.000292 mGal and standard
	deviation of $0.105$ mGal.}
	\label{fig:carajas_gz_predito_val}
}

\plot{up2000_carajas_500x500}{width=13.5cm}{
	{Caraj\'as Province, Brazil. The upward-continued gravity data using our modification of the fast equivalent layer 
	method \citep{siqueira-etal2017} that computes the forward modeling using the properties of BTTB and BCCB matrices
	(equation \ref{eq:w_Cv}). The total computation time is 0.216 seconds for processing of the $250,000$ observations.}
	\label{fig:up2000_carajas_500x500}
}